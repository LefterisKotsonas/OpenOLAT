<div class="o_page_edit_code o_form #if($lineNumbersEnabled) o_with_numbers #end">
#if($r.available("textArea") && $r.visible("textArea"))
	$r.render("textArea")
#end
</div>
<script>
	"use strict";

	function textAreaInputHandler(event) {
		if (event.keyCode === 13 || event.keyCode === 14) {
			const requiredLines = Math.min(this.value.split(/\r?\n/).length, $maxNumberOfLines);
			if (requiredLines > this.rows) {
				this.rows = requiredLines;
			}
		} else if (event.keyCode === 8 || event.keyCode === 46) {
			const requiredLines = this.value.split(/\r?\n/).length;
			if (requiredLines < this.rows) {
				this.rows = requiredLines;
			}
		}
	}

	jQuery(function() {
		const textAreaId = 'o_fi$r.getComponent("textArea").getDispatchID()';
		const textArea = document.getElementById(textAreaId);
		textArea.removeEventListener('keydown', textAreaInputHandler, false);
		textArea.addEventListener('keydown', textAreaInputHandler, false);
	});
</script>
